<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Breakfaster</title>
  </head>

  <body>
    <script
      charset="utf-8"
      src="https://static.line-scdn.net/liff/edge/2/sdk.js"
    ></script>

    <script>
      fetch('/send-id')
        .then(function (reqResponse) {
          return reqResponse.json()
        })
        .then(function (jsonResponse) {
          const myLiffId = jsonResponse.id
          initializeLiffOrDie(myLiffId)
        })
        .catch(function (error) {
          console.log(error)
        })

      function initializeLiffOrDie(myLiffId) {
        if (!myLiffId) {
          console.log('LIFF ID is not found')
        } else {
          initializeLiff(myLiffId)
        }
      }

      function initializeLiff(myLiffId) {
        liff
          .init({
            liffId: myLiffId,
          })
          .then(() => {})
          .catch((err) => {
            console.log(err)
          })
      }
    </script>
  </body>
</html>
